const i=self,o="/",a=e=>`${o.replace(/\/$/,"/")}${e.replace(/^\//,"")}`,h=[o,a("index.html"),a("manifest.webmanifest"),a("icons/icon.svg")],l="static-v2",r="runtime-v2";i.addEventListener("install",e=>{e.waitUntil(caches.open(l).then(t=>t.addAll(h)).then(()=>i.skipWaiting()))});i.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(t=>Promise.all(t.filter(n=>![l,r].includes(n)).map(n=>caches.delete(n)))).then(()=>i.clients.claim()))});i.addEventListener("fetch",e=>{const t=e.request,n=new URL(t.url);if(t.method==="GET"){if(n.origin===location.origin&&h.includes(n.pathname)){e.respondWith(caches.match(t).then(s=>s??fetch(t)));return}if(/\.(pbf|mvt|json)$/i.test(n.pathname)||n.hostname.includes("tiles")){e.respondWith(caches.open(r).then(async s=>{const d=await s.match(t),m=fetch(t).then(c=>(c&&c.status===200&&s.put(t,c.clone()),c));return d??m}));return}}});
